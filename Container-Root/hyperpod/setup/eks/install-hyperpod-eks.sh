#!/bin/bash

# Create destination
mkdir -p /hyperpod/impl/eks/src
pushd /hyperpod/impl/eks/src

# Download from S3
#aws s3 cp s3://hyperpod-eks-beta-us-west-2/20240716/hyperpodeks.tar.gz /hyperpod/impl/eks
#pushd /hyperpod/impl/eks
#tar -zxvf ./hyperpodeks.tar.gz
#mv hyperpodeks src
#rm -f ./hyperpodeks.tar.gz

# Download from Workshop

## cfn
mkdir cfn
#curl 'https://ws-assets-prod-iad-r-pdx-f3b3f9f1a7d6a3d0.s3.us-west-2.amazonaws.com/2433d39e-ccfe-4c00-9d3d-9917b729258e/hyperpod-eks-full-stack.yaml' --output cfn/hyperpod-eks-full-stack.yaml

## scripts
#mkdir scripts
#curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/scripts/create_config.sh?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output scripts/create_config.sh
#chmod +x scripts/*.sh


## lifecyclescripts
mkdir lifecyclescripts
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/lifecyclescripts/on_create.sh?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output lifecyclescripts/on_create.sh
chmod +x lifecyclescripts/*.sh


## manifests
mkdir manifests
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/burnin.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/burnin.yaml
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/efa-device-plugin.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/efa-device-plugin.yaml
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/health-monitoring-agent.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/health-monitoring-agent.yaml
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/hp-service-auth.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/hp-service-auth.yaml
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/k8s-neuron-device-plugin-rbac.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/k8s-neuron-device-plugin-rbac.yaml
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/neuron-device-plugin.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/neuron-device-plugin.yaml
curl 'https://static.us-east-1.prod.workshops.aws/1d4891ce-cfd4-4ce3-9762-5d4629633ab1/static/manifests/nvidia-device-plugin.yaml?Key-Pair-Id=K36Q2WVO3JP7QD&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9zdGF0aWMudXMtZWFzdC0xLnByb2Qud29ya3Nob3BzLmF3cy8xZDQ4OTFjZS1jZmQ0LTRjZTMtOTc2Mi01ZDQ2Mjk2MzNhYjEvKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcyNDg4NTIwOX19fV19&Signature=rvspWiEkcTPQfFrkpGXZdVrUpqxjYetFTNtMByQAre0dbzmosbgXlQQ~JNR4CZiZX~yuOxPUe7f1XIloVwUcT~6DRWjJC3MdEzxMEomvDPXBKgNE5jRzIEbfQ8sGFv7~RLO8tilBQMa1Iibx4ylpMivB6FyPcySGR1RMP~ZUmJgLXxpr6G6BZ2mb4l8wUCDrES5kwvcRWm0aMSh9tBgTDeFxvU7EaiBz4zWUXCbV5YiA7lPMD07Y2Gr7MYzAJfl0UHJWxaEcvWy-FfDy3DJrst8DhJqIfDYs9MHYBUPVLRhAgYM42aAU7xTjkD6UgwyV0P8TbfWAIqfoodHJ73K2Cg__' --output manifests/nvidia-device-plugin.yaml

